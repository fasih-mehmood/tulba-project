$(".profile").click((function(){$(".dropdown").toggle(200,"swing")}));var popup=document.querySelector(".popup-background"),btn=document.querySelector(".edit"),span=document.querySelector(".close");function close(){popup.style.display="none"}function success(){Swal.fire({icon:"success",title:"Success",confirmButtonColor:"green",text:"Your profile has been updated successfully"})}function error(message){Swal.fire({icon:"error",title:"Ops...",confirmButtonColor:"red",text:message})}btn.onclick=function(){popup.style.display="block"},span.onclick=function(){close()},window.onclick=function(event){event.target==popup&&close()};var loggedOut=!0;auth.onAuthStateChanged(user=>{user?db.collection("users").doc(currentEmail).onSnapshot(snapshot=>{setupProfile(snapshot.data()),setupEditForm(snapshot.data()),load(),loggedOut=!1}):(load(),loggedOut&&Swal.fire({icon:"error",title:"Ops...",confirmButtonColor:"red",text:"Please login before accessing your profile."}).then(()=>{window.location.href="../../index.html"}))});const setupProfile=data=>{let bio="",academics="",skills="";const biographics=document.querySelector(".biographics"),academic=document.querySelector(".academic"),skill=document.querySelector(".skills");if(bio=`\n\t\t\t<div class="row">\n\t\t\t\t<h2>Biographics</h2>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Full Name</h4>\n\t\t\t\t<p>${data.fullName}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Father's Name</h4>\n\t\t\t\t<p>${data.fathersName}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Email Address</h4>\n\t\t\t\t<p>${currentEmail}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Phone Number</h4>\n\t\t\t\t<p>${data.phone}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Gender</h4>\n\t\t\t\t<p>${data.gender}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Date of Birth</h4>\n\t\t\t\t<p>${data.dob}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Address</h4>\n\t\t\t\t<p>${data.address}</p>\n\t\t\t</div>\n\t\t`,data.isEmp){var separateExp=data.experiences.split(",");let sep="";separateExp.forEach(exp=>{sep+=`<p>${exp}</p>`}),academics=`\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h2>Academic Info</h2>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Alma Mater University Name</h4>\n\t\t\t\t\t<p>${data.uniName}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Graduation Year</h4>\n\t\t\t\t\t<p>${data.gradYear}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Graduating Discipline</h4>\n\t\t\t\t\t<p>${data.major}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Notable Experiences</h4>\n\t\t\t\t\t${sep}\n\t\t\t\t</div>\n\t\t\t`,skills=`\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h2>Company Info</h2>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Company Name</h4>\n\t\t\t\t\t<p>${data.companyName}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Year Established</h4>\n\t\t\t\t\t<p>${data.yearEstablished}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Position</h4>\n\t\t\t\t\t<p>${data.position}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Company Address</h4>\n\t\t\t\t\t<p>${data.companyAddress}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Contact Email</h4>\n\t\t\t\t\t<p>${data.companyEmail}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h4>Total Employees</h4>\n\t\t\t\t\t<p>${data.employees}</p>\n\t\t\t\t</div>\n\t\t\t`}else{academics=`\n\t\t\t<div class="row">\n\t\t\t\t<h2>Academic Info</h2>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>University Name</h4>\n\t\t\t\t<p>${data.uniName}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Discipline</h4>\n\t\t\t\t<p>${data.majSub}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Degree Status</h4>\n\t\t\t\t<p>${data.degreeStat}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>Graduation Year</h4>\n\t\t\t\t<p>${data.gradYear}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>CGPA</h4>\n\t\t\t\t<p>${data.cgpa}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>School Email</h4>\n\t\t\t\t<p>${data.schoolEmail}</p>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<h4>linkedIn</h4>\n\t\t\t\t<p>${data.linkedIn}</p>\n\t\t\t</div>\n\t\t\t`;var separateSkills=data.skills.split(",");let sep="";separateSkills.forEach(skill=>{sep+=`<li>${skill}</li>`}),skills=`\n\t\t\t\t<div class="row">\n\t\t\t\t\t<h2>Skills</h2>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t${sep}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t`}biographics.innerHTML=bio,academic.innerHTML=academics,skill.innerHTML=skills},setupEditForm=data=>{let html=`\n\t\t<div class="row">\n\t\t\t<div class="col span-1-of-2">\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="homeAddress">Home Address</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="homeAddress" name="address" type="text" placeholder="Enter Home Address" value="${data.address}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="phone">Phone Number</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="phone" name="phone" type="tel" placeholder="Enter Phone Number" value="${data.phone}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="linkedIn">linkedIn Profile</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="linkedIn" type="text" name="linkedIn" placeholder="linkedIn Profile" value="${data.linkedIn}"/>\n\t\t\t\t</div>\n\t`;data.isEmp?html+=`\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="experiences">Experiences</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<textarea id="experiences" name="experiences" wrap="soft" placeholder="Enter experiences separated by commas" required>${data.experiences}</textarea>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col span-1-of-2">\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="companyName">Company Name</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="companyName" name="companyName" type="text" placeholder="Enter Company Name" value="${data.companyName}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="companyAddress">Company Address</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="companyAddress" name="companyAddress" type="text" placeholder="Enter Company Address" value="${data.companyAddress}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="position">Company Position</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="position" name="position" type="text" placeholder="Enter Company Position" value="${data.position}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="companyEmail">Company Email</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="companyEmail" type="email" name="companyEmail" placeholder="Enter Company Email" value="${data.companyEmail}" required />\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="employees">Total Employees</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="employees" name="employees" min='0' type="number" placeholder="Enter Number of Employees" value="${data.employees}" required/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t`:html+=`\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="skills">Skills</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<textarea id="skills" name="skills" wrap="soft" placeholder="Enter skills separated by commas" required>${data.skills}</textarea>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col span-1-of-2">\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="uniName">University Name</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="uniName" name="uniName" type="text" placeholder="University Name" value="${data.uniName}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="uniEmail">School Email</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t<input id="uniEmail" type="email" name="uniEmail" placeholder="University Email Address" value="${data.schoolEmail}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="majSub">Discipline</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="majSub" name="majSub" type="text" placeholder="Major" value="${data.majSub}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="year">Graduation Year</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="year" name="year" min="1930" max="2030" step="1" type="number" placeholder="Graduation Year" value="${data.gradYear}" required/>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<label for="cgpa">CGPA</label>\n\t\t\t\t</div>\n\t\t\t\t<div class="row">\n\t\t\t\t\t<input id="cgpa" name="cgpa" min="0" max="4" step="0.01" type="number" placeholder="Enter CGPA" value="${data.cgpa}" required/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t`,html+='\n\t\t<div class="row row-submit">\n\t\t\t<button class="back-icon submit-btn" type="submit"><i class="ion-android-arrow-dropright-circle"></i></button>\n\t\t</div>\n\t',editForm.innerHTML=html},editForm=document.querySelector("#editProfile");editForm.addEventListener("submit",e=>{e.preventDefault(),success(),close(),isEmp?db.collection("users").doc(currentEmail).update({address:editForm.address.value,phone:parseInt(editForm.phone.value,10),linkedIn:editForm.linkedIn.value,experiences:editForm.experiences.value,companyName:editForm.companyName.value,companyAddress:editForm.companyAddress.value,companyEmail:editForm.companyEmail.value,position:editForm.position.value,employees:parseInt(editForm.employees.value,10)}).then(()=>{editForm.reset()}).catch(err=>{error(err.message)}):db.collection("users").doc(currentEmail).update({address:editForm.address.value,phone:parseInt(editForm.phone.value,10),linkedIn:editForm.linkedIn.value,skills:editForm.skills.value,uniName:editForm.uniName.value,schoolEmail:editForm.uniEmail.value,majSub:editForm.majSub.value,gradYear:editForm.year.value,cgpa:parseFloat(editForm.cgpa.value)}).then(()=>{editForm.reset()}).catch(err=>{error(err.message)})});